@*
 * Copyright 2020 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import selfservicetimetopay.partials.currency
@import uk.gov.hmrc.selfservicetimetopay.models.{CalculatorPaymentSchedule, ArrangementDayOfMonth, Debit}
@import uk.gov.hmrc.selfservicetimetopay.controllers.routes
@import selfservicetimetopay.partials._
@(paymentSchedule: CalculatorPaymentSchedule)(implicit messages: play.api.i18n.Messages)
<div id="id_payment" class="margin-top-40">
    <dl class="app-check-your-answers app-check-your-answers--long">
        @*upfront payment*@
        <div class="app-check-your-answers__contents">
            <dt class="app-check-your-answers__question">
                @Messages("ssttp.arrangement.instalment-summary.up-front-payment")
            </dt>
            <dd class="app-check-your-answers__answer">
            @currency(paymentSchedule.getUpFrontPayment)
            </dd>
            <dd class="app-check-your-answers__change" onclick="change()">
                <a href="@routes.CalculatorController.getPayTodayQuestion()">@Messages("ssttp.arrangement.instalment-summary-table.monthly-instalments-change") <span class="visually-hidden">@Messages("ssttp.arrangement.instalment-summary-table.monthly-instalments")</span></a>
            </dd>
        </div>

        @*collected on date*@
        <div class="app-check-your-answers__contents">
            <dt class="app-check-your-answers__question">
            @Messages("ssttp.arrangement.instalment-summary.payment-date.title")
            </dt>
            <dd class="app-check-your-answers__answer">
                @paymentSchedule.getMonthlyDateFormatted @Messages("ssttp.arrangement.instalment-summary.payment-date.ending")
            </dd>
            <dd class="app-check-your-answers__change">
                <td><a href="@routes.ArrangementController.getChangeSchedulePaymentDay()">@Messages("ssttp.arrangement.instalment-summary.payment-date.change")</a></td>
            </dd>
        </div>

        @*monthly instalments (total number)*@
        <div class="app-check-your-answers__contents">
            <dt class="app-check-your-answers__question">
                @Messages("ssttp.arrangement.instalment-summary-table.monthly-instalments")
                <p>@{
                    paymentSchedule.instalments.map { instalment => <p>{instalment.getDateInReadableFormat}</p> }
                }</p>
                <p class="small">@Messages("ssttp.arrangement.instalment-summary-table.total-interest-hint", currency(paymentSchedule.totalInterestCharged))</p>
            </dt>
            <dd class="app-check-your-answers__answer">
                <br>
                <p>@{
                    paymentSchedule.instalments.map { instalment => <p>{currency(instalment.amount)}</p> }
                }</p>
            </dd>

            <dd class="app-check-your-answers__change">

                <a href="@routes.CalculatorController.getCalculateInstalments()">@Messages("ssttp.arrangement.instalment-summary-table.monthly-instalments-change") <span class="visually-hidden">@Messages("ssttp.arrangement.instalment-summary-table.monthly-instalments")</span></a>
            </dd>
        </div>

        @*total repayment*@
        <div class="app-check-your-answers__contents">
            <dt class="app-check-your-answers__question">
                @Messages("ssttp.arrangement.instalment-summary-table.total-repayment")
            </dt>
            <dd class="app-check-your-answers__answer">
            @currency(paymentSchedule.totalPayable)
            </dd>
            <dd class="app-check-your-answers__change">
            </dd>
        </div>
    </dl>

</div>

<script type="text/javascript">
        function change() {
            window['optimizely'] = window['optimizely'] || [];
            window['optimizely'].push({
                type: "event",
                eventName: "change-btn",
                tags: {
                    revenue: 0, // Optional in cents as integer (500 == $5.00)
                    value: 0.00 // Optional as float
                }
            });
        }
</script>
