@*
 * Copyright 2018 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@*
Time To Pay Instalment Summary Pretty Print Page
@param schedule CalculatorPaymentSchedule The results data to display
*@
@import uk.gov.hmrc.selfservicetimetopay.models.{CalculatorPaymentSchedule,ArrangementDayOfMonth,Debit}
@(debits:Seq[Debit],initialPayment:BigDecimal, schedule: CalculatorPaymentSchedule, dayForm: Form[ArrangementDayOfMonth], signedIn: Boolean = true)(implicit messages: play.api.i18n.Messages, request: Request[_])
@import selfservicetimetopay.partials.{payment_schedule, gaDoCheckout}
@import selfservicetimetopay.helpers.{alert, message_list}
@import selfservicetimetopay.helpers.forms.submit
@import uk.gov.hmrc.play.views.html.helpers
@import uk.gov.hmrc.selfservicetimetopay.controllers.routes
@import selfservicetimetopay.partials.instalments_plan_summary_table
@gaCheckoutCode = {
    @gaDoCheckout(debits = debits,
        step = 1,
        revenue = schedule.totalPayable,
        initialPayment = Some(schedule.initialPayment),
        interest = schedule.totalInterestCharged,
        duration = schedule.instalments.length,
        regularPayment = schedule.instalments.head.amount,
        paymentDay = schedule.instalments.head.paymentDate.getDayOfMonth
    )
}
@selfservicetimetopay.main(
        title = Messages("ssttp.arrangement.instalment-summary.title"),
        googleAnalyticsCalls = Seq(gaCheckoutCode.body.seq),
        loggedIn = signedIn
    ) {
       <a class="link-back" href="@routes.CalculatorController.getCalculateInstalments()">@Messages("ssttp.calculator.form.back")</a>

        <h1 class="heading-large">@Messages("ssttp.arrangement.instalment-summary.title")</h1>

        <div class="summary_payment margin-top-40">
            <dl class="app-check-your-answers app-check-your-answers--long">
                    <div class="app-check-your-answers__contents">
                      <dt class="app-check-your-answers__question">
                        @Messages("ssttp.calculator.form.payment_summary.up-front-payment")
                        <p class="small">@Messages("ssttp.calculator.form.payment_summary.up-front-payment.hint")</p>
                      </dt>
                      <dd class="app-check-your-answers__answer">
                        Â£@initialPayment
                      </dd>
                      <dd class="app-check-your-answers__change">
                          <a href="@routes.CalculatorController.getPaymentToday()">@Messages("ssttp.calculator.form.payment_summary.up-front-payment.change") <span class="visually-hidden">@Messages("ssttp.calculator.form.payment_summary.up-front-payment")</span></a>
                        </dd>
                    </div>
                    </dl>

        </div>

        @instalments_plan_summary_table(schedule)

             <details @if(dayForm.hasErrors) {open} class="margin-top-30 margin-bottom-30">
                <summary><span class="summary">@Messages("ssttp.arrangement.instalment-summary.payment-day.change")</span></summary>
                <div class="panel-indent">
                    @helpers.form(routes.ArrangementController.changeSchedulePaymentDay(), 'id -> "arrangementPaymentDayForm") {
                        @helpers.input(dayForm("dayOfMonth"),
                            'label -> Messages("ssttp.arrangement.instalment-summary.payment-day.change.take-payment-on"),
                            '_labelClass -> "label--inline", '_inputClass -> "input--xsmall",
                            'labelSuffix -> Messages("ssttp.arrangement.instalment-summary.payment-day.change.of-the-month"))
                        @submit('_buttonClass -> "button--secondary") {
                            @Messages("ssttp.arrangement.instalment-summary.payment-day.submit")
                        }
                    }
                </div>
            </details>

        <section>
           <div class="panel panel-border-wide">
                @Messages("ssttp.arrangement.instalment-summary.terms.cancelled-if")
                     <br></br>
                @message_list(Some("bullets"), "ssttp.arrangement.instalment-summary.terms.cancelled-if.")
                <div class="subsection">@Messages("ssttp.arrangement.instalment-summary.terms.made-payable-immediately")</div>
                <div class="subsection">@Messages("ssttp.arrangement.instalment-summary.terms.refunds")</div>
                <div class="subsection">@Messages("ssttp.arrangement.instalment-summary.terms.interest-change")</div>
                <div class="subsection">@Messages("ssttp.arrangement.instalment-summary.terms.future-debts")</div>
            </div>
            @helpers.form(routes.ArrangementController.submitInstalmentSummary()) {
                @submit() {
                    @Messages("ssttp.arrangement.instalment-summary.submit")
                }
      }
        </section>
        <div>&nbsp;</div>


    }
