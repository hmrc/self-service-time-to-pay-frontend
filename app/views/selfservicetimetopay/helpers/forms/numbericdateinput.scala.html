@*
 * Copyright 2018 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@(name: String, frm:Form[_], yearField: Field, monthField: Field, dayField: Field, args: (Symbol, String)*)(implicit messages: play.api.i18n.Messages, lang: Lang = Lang("en"))
@import java.time.Month
@import java.time.format.TextStyle
@import views.html.helper.FieldElements
@import selfservicetimetopay.helpers.forms.{formErrors, fieldset, fieldErrors, numberinput, errorList}
@argsMap = @{ args.toMap }
@dayElements = @{ new FieldElements(dayField.id, dayField, null, argsMap, messages) }
@monthElements = @{ new FieldElements(monthField.id, monthField, null, argsMap, messages) }
@yearElements = @{ new FieldElements(yearField.id, yearField, null, argsMap, messages) }
@monthOptions = @{for(m <- 1 to 12) yield (m.toString, Month.of(m).getDisplayName(TextStyle.FULL, lang.toLocale))}
@fieldsetErrorsClass = @{
    var errorsClass = if(frm.error(name).nonEmpty){"soft--right "}else{""}
    if(yearField.errors.nonEmpty || monthField.errors.nonEmpty || dayField.errors.nonEmpty) {
        errorsClass += "form-field-group--error form-field--error"
    }
    errorsClass.trim
}
@fieldset(frm, name, '_modifierClass -> fieldsetErrorsClass){
    @if(argsMap.get('label).isDefined){<legend>@argsMap.get('label)</legend>}
    @if(argsMap.getOrElse('_hideErrors, "false").contentEquals("false")){@formErrors(frm, '_field -> name)}
    @if(frm.errors.length > 1){<span class="error-notification" role="alert">@Messages("ssttp.calculator.form.what-you-owe.due_by.not-valid-date")</span>}else{
        @fieldErrors(yearField)
        @fieldErrors(monthField)
        @fieldErrors(dayField)
    }
    <ul class="list--inline group">
        <li>
        @numberinput(dayField, 'label -> argsMap.getOrElse('dayLabel, ""),
            'step -> 1,
            '_modifierClass -> "form-field--inline",
            '_labelClass -> "label--inline-tight",
            '_inputClass -> "input--cleared input--xxsmall input--no-spinner ssttp-margin-numericdateinput",
            '_hideErrors -> true,
            '_required -> true)
        </li>
        <li>
        @numberinput(monthField,'label -> argsMap.getOrElse('monthLabel, ""),
            '_modifierClass -> "gutter-left form-field--inline",
            'step -> 1,
            '_labelClass -> "label--inline-tight",
            '_inputClass -> "input--cleared input--xxsmall input--no-spinner ssttp-margin-numericdateinput",
            '_hideErrors -> true,
            '_required -> true)
        </li>
        <li>
        @numberinput(yearField,
            'label -> argsMap.getOrElse('yearLabel, ""),
            'step -> 1,
            '_labelClass -> "gutter-left label--inline-tight",
            '_modifierClass -> "form-field--inline",
            '_inputClass -> "input--cleared input--xsmall input--no-spinner ssttp-margin-numericdateinput",
            '_hideErrors -> true,
            '_required -> true)
        </li>
    </ul>
    @if(argsMap.get('hint).isDefined) {
        <div class="form-hint form-hint--small float--left">@argsMap.get('hint)</div>
    }
}