@*
 * Copyright 2023 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@(field: Field, args: (Symbol, Any)*)(implicit messages: play.api.i18n.Messages, lang: Lang = Lang("en"))
@import helpers.labelWrap
@import views.html.helper.FieldElements
@argsMap = @{ args.toMap }
@elements = @{ FieldElements(field.id, field, Html(""), argsMap, messages) }
@value = @{ field.value.getOrElse("") }
@inputClass = @{
    val classes :String = argsMap.getOrElse(Symbol("_inputClass"), "").toString
    (if(field.hasErrors) classes + " error-field" else classes).trim
}
<div>
    @labelWrap(Symbol("labelText") -> argsMap.getOrElse(Symbol("label"), ""), Symbol("for") -> elements.field.name, Symbol("_modifierClass") -> argsMap.get(Symbol("_labelClass"))){
        @if(argsMap.get(Symbol("hint")).isDefined) {<div class="form-hint form-hint--small">@argsMap.get(Symbol("hint"))</div>}
        <input type="text"@if(inputClass.nonEmpty){ class="@inputClass" } name="@elements.field.name" id="@elements.field.name" value="@value"
            @if(elements.args.contains(Symbol("_dataAttributes")) ){ @elements.args.get(Symbol("_dataAttributes"))}
            @if(elements.args.get(Symbol("_autoComplete")) ){ autocomplete="@elements.args.get(Symbol("_autoComplete"))" }
            @if(elements.args.get(Symbol("_error_id")).isDefined) { aria-labeledby="@elements.args.get(Symbol("_error_id"))" }
            @if(elements.args.get(Symbol("_hintId")).isDefined) { aria-describedby="@elements.args.get(Symbol("_hintId"))" }
            @if(elements.args.get(Symbol("_maxlength")).isDefined) { maxlength="@elements.args.get(Symbol("_maxlength"))" }
            @if(elements.args.get(Symbol("_max")).isDefined) { max="@elements.args.get(Symbol("_max"))" }
            @if(elements.args.get(Symbol("_pattern")).isDefined) { pattern="@elements.args.get(Symbol("_pattern"))" }
            @if(elements.args.get(Symbol("_title")).isDefined) { title="@elements.args.get(Symbol("_title"))" }
            @if(elements.args.get(Symbol("datalist")).isDefined) { list="@{elements.field.name}_datalist" }
        />
        @if(elements.args.get(Symbol("datalist")).isDefined) {
            <datalist id="@{elements.field.name}_datalist">
            @{
                elements.args(Symbol("datalist")) match {
                    case t:Iterable[_] => t.foreach( v => <option value="@v"/> )
                    case _ => ""
                }
            }
            </datalist>
        }
    }
</div>
