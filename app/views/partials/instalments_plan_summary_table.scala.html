@*
 * Copyright 2023 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import uk.gov.hmrc.selfservicetimetopay.models.{ArrangementDayOfMonth}
@import timetopaytaxpayer.cor.model.Debit
@import ssttpcalculator.model.PaymentSchedule
@import _root_.model._
@import model._
@import language.Dates

@(
        paymentSchedule: PaymentSchedule)(
        implicit
        messages: play.api.i18n.Messages,
        appConfig: config.AppConfig
)

<div id="id_payment" class="govuk-body margin-top-40">
  <dl id="instalment-summary-list" class="govuk-summary-list">
    @*upfront payment*@
    <div class="govuk-summary-list__row">
      <dt class="govuk-summary-list__key">
      @Messages("ssttp.arrangement.instalment-summary.up-front-payment")
      </dt>
      <dd class="govuk-summary-list__value">
      @partials.currency(paymentSchedule.getUpFrontPayment)
      </dd>
      <dd class="govuk-summary-list__actions" onclick="change()">
        <a href="@ssttpcalculator.routes.CalculatorController.getPayTodayQuestion()"
           title='@Messages("ssttp.arrangement.instalment-summary-table.upfront.payments.link-title")'
           aria-label='@Messages("ssttp.arrangement.instalment-summary-table.upfront.payments.link-title")'>
            @Messages("ssttp.arrangement.instalment-summary-table.monthly-instalments-change")
            <span class="govuk-visually-hidden">@Messages("ssttp.arrangement.instalment-summary-table.monthly-instalments")</span>
        </a>
      </dd>
    </div>

    @*collected on date*@
      <div class="govuk-summary-list__row">
      <dt class="govuk-summary-list__key">
      @Messages("ssttp.arrangement.instalment-summary.payment-date.title")
      </dt>
      <dd class="govuk-summary-list__value">
        @paymentSchedule.getMonthlyDateFormatted @Messages("ssttp.arrangement.instalment-summary.payment-date.ending")
      </dd>
      <dd class="govuk-summary-list__actions">
        <a href="@ssttparrangement.routes.ArrangementController.getChangeSchedulePaymentDay()"
        title='@Messages("ssttp.arrangement.instalment-summary.payment-date.change.link-title")'
        aria-label='@Messages("ssttp.arrangement.instalment-summary.payment-date.change.link-title")'>
            @Messages("ssttp.arrangement.instalment-summary.payment-date.change")
        </a>
      </dd>
    </div>

    @*monthly instalments (total number)*@
    <div class="govuk-summary-list__row govuk-summary-list__row--no-border">
      <dt class="govuk-summary-list__key">
        @Messages("ssttp.arrangement.instalment-summary-table.monthly-instalments")
      </dt>
      <dd class="govuk-summary-list__value">
      </dd>
      <dd class="govuk-summary-list__actions">
        <a href="@ssttpcalculator.routes.CalculatorController.getCalculateInstalments()"
           title='@Messages("ssttp.arrangement.instalment-summary-table.monthly-instalments.link-title")'
           aria-label='@Messages("ssttp.arrangement.instalment-summary-table.monthly-instalments.link-title")'
        >
            @Messages("ssttp.arrangement.instalment-summary-table.monthly-instalments-change")
          <span class="govuk-visually-hidden">
            @Messages("ssttp.arrangement.instalment-summary-table.monthly-instalments")
          </span>
        </a>
      </dd>
    </div>
    @{
      paymentSchedule.instalments.map { instalment => <div class="govuk-summary-list__row govuk-summary-list__row--no-border">
      <dt class="govuk-summary-list__key">{Dates.getMonthFormatted(instalment.paymentDate)} {instalment.paymentDate.getYear}</dt>
      <dd class="govuk-summary-list__value">{partials.currency(instalment.amount)}</dd>
      <dd class="govuk-summary-list__actions"></dd></div>}
      }
      <div class="govuk-summary-list__row govuk-summary-list__row--no-border">
          <dt class="govuk-summary-list__key">
              <p class="govuk-body-s">@Messages("ssttp.arrangement.instalment-summary-table.total-interest-hint", partials.currency(paymentSchedule.totalInterestCharged))</p>
          </dt>
          <dd class="govuk-summary-list__value">
          </dd>
          <dd class="govuk-summary-list__actions">
          </dd>
      </div>

    @*total repayment*@
    <div class="govuk-summary-list__row">
      <dt class="govuk-summary-list__key">
      @Messages("ssttp.arrangement.instalment-summary-table.total-repayment")
      </dt>
      <dd class="govuk-summary-list__value">
      @partials.currency(paymentSchedule.totalPayable)
      </dd>
      <dd class="govuk-summary-list__actions">
      </dd>
    </div>
  </dl>

</div>
